<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Диалоги</title>
    <link href="../../css/styles.css" rel="stylesheet" type="text/css">
    <link href="../../fonts/font_styles.css" rel="stylesheet" type="text/css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        window.onload = unit;
        function unit() {
            document.getElementById('change_photo_form').style.display = 'none';

            let button_add_chat = document.getElementById('add_chat_id');
            let field_creating_chat = document.getElementById('creating_chat');
            let nav_menu = document.getElementById('nav_menu_id');
            let burger_logo = document.getElementById('burger_logo_id');
            let burger_logo_user = document.getElementById('burger_logo_user');
            let container_creating_chat = document.getElementById('container_creating_chat_id');
            let open_settings = document.getElementById('open_settings_ico');
            let open_aboutus = document.getElementById('open_about_ico');
            let open_logout = document.getElementById('open_logout_ico');
            let settings = document.getElementById('settings-container-id');
            let back_settings = document.getElementById('back_id');
            let change_img_btn = document.getElementById('change_photo');

            button_add_chat.addEventListener('click', function () {
                field_creating_chat.style.display = 'block';
                container_creating_chat.style.display = 'flex';
            });
            let button_creating_chat = document.getElementById("creating_chat_id");

            button_creating_chat.addEventListener("click", function () {
                field_creating_chat.style.display = 'none';
                document.getElementById('title_chat_id').innerText = document.getElementById('text_id').value;
            });

            document.addEventListener('click', (e) => {
                const withinCreatingChat = e.composedPath().includes(container_creating_chat);
                const withinButton = e.composedPath().includes(button_add_chat);
                const withinNavMenu = e.composedPath().includes(nav_menu);
                const withinBurger = e.composedPath().includes(burger_logo);
                const withinSettings = e.composedPath().includes(open_settings);
                const withinContainerSettings = e.composedPath().includes(settings);
                const backSettings = e.composedPath().includes(back_settings);

                if ((!withinCreatingChat) && (!withinButton)) {
                    field_creating_chat.style.display = 'none';
                }
                if ((!withinNavMenu) && (!withinBurger)){
                    nav_menu.style.display = 'none';
                }
                if ((!withinContainerSettings) && (!withinSettings) && (settings.style.display === 'block') || (backSettings)){
                    document.getElementById('filter').style.display = 'none';
                    if(document.getElementById('message-field-id') != null) {
                        document.getElementById('message-field-id').style.background = '#FFF';
                    }
                    settings.classList.add('hide-set');
                    settings.classList.remove('show-set');
                    setTimeout(() => settings.style.display = 'none', 150);
                }
            });

            burger_logo.addEventListener('click', function (){
                nav_menu.style.display = 'block';
            });

            burger_logo_user.addEventListener('click', function (){
                nav_menu.style.display = 'none';
            });

            open_settings.addEventListener('click', function(){
                settings.style.display = 'block';
                nav_menu.style.display = 'none';
                document.getElementById('filter').style.display ='block';
                if(document.getElementById('message-field-id') != null) {
                    document.getElementById('message-field-id').style.background = '#DED1D1';
                }
                settings.classList.add('show-set');
                settings.classList.remove('hide-set');
            });

            change_img_btn.addEventListener('click', function(){
                document.getElementById('change_photo_form').style.display = 'block';
            });
        }
    </script>
</head>
<style>
    body{
        width: 100%;
        height: 100%;
        margin: 0;
        font-family: Montserrat;
        background: linear-gradient(129deg, #636DEA 258px, #EA636D 1150px);
    }
    ::-webkit-scrollbar {
        width: 0;
        height: 0;
    }
    #filter{
        position: absolute;
        display: none;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0, .3);
        backdrop-filter: blur(5px);
    }
    #open_settings_ico{
        cursor: pointer;
    }
    #open_about_ico{
        cursor: pointer;
    }
    .show-set{
        display: block;
        animation: showBlock .2s linear;
    }
    @keyframes showBlock {
        from{
            opacity: 0;
        }
        to{
            opacity: 1;
        }
    }
    .hide-set{
        display: block;
        animation: hideBlock .2s linear;
    }
    @keyframes hideBlock {
        from{
            opacity: 1;
        }
        to{
            opacity: 0;
        }
    }
    .settings-container{
        display: none;
        border-radius: 10px;
        width: 336px;
        height: 518px;
        position: absolute;
        background: #F8F8F8;
        z-index: 5;
        left: 50%;
        top: 50%;
        margin-left: -118px;
        margin-top: -259px;
    }
    .title-settings{
        width: 300px;
        height: 55px;
        margin: auto;
        display: flex;
    }

    #back_id:hover{
        cursor: pointer;
    }
    .arrow-wrapp{
        width: 52px;
        height: 55px;
        display: flex;
        align-items: center;
    }
    .arrow-wrapp img{
        display: block;
        margin-left: 0;
    }
    .photo-field{
        display: flex;
        background: rgba(99,109,234, .3);
        height: 155px;
        align-items: center;
        justify-content: space-evenly;
        flex-direction: column;
        box-shadow: inset 2px 2px 6px 0px rgb(99 109 234 / 18%), inset 1px 0px 5px rgb(80 44 44 / 0%);
    }
    .photo-field button{
        width:131px;
        height: 30px;
        border-radius: 15px;
        background: #6C72C6;
        outline: none;
        border: none;
        box-shadow: none;
        transition-duration: .2s;
        color: #FFFFFF;
        font-size: 12px;
        font-weight: 600;
    }
    .photo-field button:hover{
        background: #4C508A;
        transition-duration: .2s;
        cursor: pointer;
    }
    .edit-field{
        width:100%;
        height: 130px;
    }
    .edit-str{
        margin: auto;
        display: flex;
        width:300px;
        height: 65px;
        align-items: center;
        transition-duration: .2s;

    }
    .edit-field-wrap{
        width: 100%;
        transition-duration: .2s;
    }
    .edit-field-wrap:hover {
        transition-duration: .2s;
        cursor: pointer;
        background: #e7ecee;
    }
    .edit-pen{
        width: 121px;

        display: none;
        justify-content: flex-end;
    }
    .edit-field-wrap:hover .edit-pen{
        display: flex;
        transition-duration: .2s;
    }
    .edit-str p{
        padding: 0;
        margin: 0;
    }
    .text-div{
        width: 127px;
        display: flex;
        justify-content: center;
        flex-direction: column;
    }
    .text-div p{
        color: rgba(29,32,71, .75);
        font-size: 12px;
    }
    #username_edited_id{
        color: #1D2047;
        font-size: 13px;
        font-weight: 500;
    }
    #password_edited_id{
        color: #1D2047;
        font-size: 13px;
        font-weight: 500;
    }
    .image-div{
        width: 72px;
        height: 72px;
        border-radius: 50%;
    }
    .field-aboutme p{
        cursor: default;
        display: block;
        margin: auto;
        width: 300px;
        padding-top: 20px;
        color: rgba(29,32,71, .75);
        font-size: 13px;
    }

    .edit-line{
        box-shadow: inset 2px 2px 6px 0px rgb(99 109 234 / 18%), inset 1px 0px 5px rgb(80 44 44 / 0%);
        width: 100%;
        height: 15px;
        background: rgba(99,109,234, .3);

    }
    .title-name{
        display: flex;
        align-items: center;
        font-weight: 500;
        font-size: 15px;
    }
    .field-aboutme{

    }
    .field-aboutme input{
        display: block;
        margin:auto;
        border: none;
        outline: none;
        width: 300px;
        height: 50px;
        border-bottom: 2px solid rgba(99,109,234, .3);
        font-size: 13px;
        font-family: Montserrat;
    }
    .field-aboutme input::placeholder{
        color: rgba(29,32,71, .75);
        font-size: 13px;
        font-family: Montserrat;
    }
    .all_chat{
        position: relative;
        display: flex;
    }
    .chatroom{
        width: 28%;
        height: 100vh;
        overflow: scroll;
    }
    .searchchat{
        width: 100%;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: space-evenly;
    }

    .burger_logo{
        margin-left: 10px;
    }

    .burger_logo img{
        width: 37px;
    }
    .search_input{
        width:320px;
        height: 39px;
        display: flex;
        border-radius: 8px;
        margin: 0;
        padding: 0;
        box-shadow: inset 2px 2px 6px 0px rgb(99 109 234 / 18%), inset 1px 0px 5px rgb(80 44 44 / 0%);
        background: rgb(240 241 255);
    }
    .search_input input{
        height:39px;
        width: 275px;
        border-radius: 0 8px 8px 0;
        background: rgba(233, 235, 252, 0);
        outline: none;
        border:none;
        padding: 0;
        margin: 0;
        font-family: Montserrat;
        font-size: 16px;
        font-weight: 500;
    }
    .search_input input::placeholder{

    }
    .search_input button{
        cursor: pointer;
        width: 45px;
        height: 39px;
        border-radius: 8px 0 0 8px;
        background: rgba(233, 235, 252, 0);
        border:none;
        outline: none;
        padding: 0;
        margin: 0;
    }
    .search_input button img{
        width: 20px;
    }
    .add_chat{
        position: fixed;
        width: 28%;
        bottom: 0;
        height: 120px;
        margin-top: 18px;
        text-align: center;
    }
    .add_chat button{
        background-color: rgba(0,0,0,0);
        border:none;
        width: 80px;
        height: 80px;
    }
    .add_chat img:hover{
        cursor: pointer;
        filter: brightness(30%);
    }
    .container_chat_info{
        display: flex;
        transition-duration: .2s;
    }
    .container_chat_info:hover{
        background: #4750BF;
        transition-duration: .2s;
    }
    .chat_info .container{
        margin: 0;
        width: 100%;
        height: 95px;
    }
    .chat_info .chat_logo{
        width: 23%;
        height: 95px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .chat_info .chat_logo img{
        width: 65px;
    }
    .chat_info .description{
        width: 57%;
        height: 95px;
        display: flex;
        align-items: center;
        justify-content: start;
    }
    .container_description{

    }
    .chat_info .title{
        text-align: start;
        font-size: 16px;
        font-weight: 600;
        color: #FFFFFF;
    }
    .chat_info .subtitle{
        text-align: start;
        font-size: 15px;
        font-weight: 500;
        color: rgba(255,255,255, 0.7);
    }
    .chat_info .measurement{
        height: 95px;
        width: 20%;
        font-size: 14px;
        color: #FFFFFF;
        font-weight: normal;
        display: flex;
        flex-direction: column;
        justify-content: space-evenly;
        align-items: center;
    }
    .circle{
        color: #636DEA;
        font-size: 14px;
        font-weight: 500;
        width:25px;
        height: 25px;
        border-radius: 50%;
        background: rgba(255,255,255,1);
        display: flex;
    }
    .circle p{
        display: block;
        margin: auto;
    }
    .creating_chat{
        position: fixed;
        display: none;
        width:28%;
        bottom: 140px;


    }
    #container_creating_chat_id{
        background: rgba(255,255,255, 1);
        width: 231px;
        height: 324px;
        margin: auto;
        border-radius: 12px;
        display: flex;
        flex-direction: column;
        justify-content: space-evenly;
        align-items: center;
    }
    .container_creating_chat .input_wrapper{
        height: 22px;
        width: 180px;
        border-bottom: 1px solid rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .container_creating_chat input{
        font-family: Montserrat;
        outline: none;
        border: none;
        font-size: 13px;
        font-width: normal;
        color: #343657;
    }
    .title_creating_chat{
        font-size: 16px;
        font-weight: 600;
        color: #343657;
    }
    #creating_chat_id{
        width: 175px;
        height: 41px;
        border-radius: 19px;
        outline: none;
        box-shadow: none;
        border:none;
        color: #FFFFFF;
        font-size: 14px;
        font-family: Montserrat;
        font-weight: 500;
        background: #636DEA;
        transition-duration: .2s;
    }
    #creating_chat_id:hover{
        background: #4750BF;
        transition-duration: .2s;
        cursor: pointer;
    }
    #chat_field_id{
        background: #FFFFFF;
        width: 72%;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    #hello_logo_id{
        display: flex;
        align-items: center;
        height: 63px;
    }
    .hello_logo img{
        width: 63px;
    }
    .hello_logo h2{
        font-size: 15px;
        font-weight: 500;
    }
    .hello_logo h3{
        font-size: 15px;
        font-weight: normal;
    }
    #chat_field_wrapper_id{
        display: block;
    }
    .chat_name{
        width: 100%;
        display: flex;
        height: 60px;
        font-size: 20px;
        font-width: 600;
        color: #FFFFFF;
        align-items: center;
        justify-content: center;

    }
    #message-field-id{
        background: #FFF;
        position: relative;
        width: 100%;
        overflow: scroll;
        height: calc(100vh - 120px);
    }
    .chat-panel{
        position: absolute;
        width: 72%;
        bottom: 0;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .chat-panel-wrapper{
        width: 800px;
        height: 41px;
        display: flex;
        align-items: center;
        justify-content: center;

    }
    .chat-panel-wrapper input{
        font-family: Montserrat;
        font-size: 16px;
        font-weight: normal;
        width: 800px;
        height: 39px;
        border-radius: 8px;
        border: none;
        box-shadow: none;
        background: rgba( 0,0,0,.2);
        padding-left: 15px;
    }
    .chat-panel-wrapper input::placeholder{
        color: rgba( 255,255,255,.8);
    }
    .chat-panel-wrapper button{
        display: flex;
        align-items: center;
        outline: none;
        border: none;
        box-shadow: none;
        width: 39px;
        height: 39px;
        background: none;
    }
    .chat-panel-wrapper button img{
        width: 39px;
    }
    #nav_menu_id{
        display: none;
        color: #000000;
        font-family: Montserrat;
        font-size: 15px;
        font-weight: normal;
        position: fixed;
        width: 23%;
        height: 100vh;
        background: #F8F8F8;
        box-shadow: 15px 1px 16px 8px rgb(0 0 0 / 19%);
        z-index: 10;
    }
    .user_logo{
        height: 124px;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    .user_logo img{
        width: 86px;
    }
    .user_name{
        font-size: 15px;
        font-weight: normal;
        text-align: center;
        height: 50px;
    }
    .block-wrapper{
        width: 240px;
        height: 220px;
        margin: auto;
    }
    .lo{
        height: 120px
    }
    .block-wrapper .nav_block{
        height: 55px;
        display: flex;
        align-items: center;
    }
    .log_out_div{
        width: 100%;
        position: absolute;
        bottom: 0;
        display: flex;
    }
    a{
        cursor: pointer;
    }
    #open_about_ico{
        display: flex;
        align-items: center;
        height: 30px;
        text-decoration: none;
        margin-left: 10px;
    }
    #open_about_ico:before{
        content: '';
        display: block;
        position: relative;
        margin-right: 10px;
        float: left;
        vertical-align: center;
        width:31px;
        height: 31px;
        background-image: url("images/about_us.svg");
        background-repeat: no-repeat;
    }
    #open_settings_ico{
        display: flex;
        align-items: center;
        height: 30px;
        text-decoration: none;
        margin-left: 10px;
    }
    #open_settings_ico:before{
        content: '';
        display: block;
        position: relative;
        margin-right: 10px;
        float: left;
        vertical-align: center;
        width:30px;
        height: 30px;
        background-image: url("images/settings.svg");
        background-repeat: no-repeat;
    }
    #open_logout_ico{
        display: flex;
        align-items: center;
        height: 30px;
        text-decoration: none;
        margin-left: 10px;
    }
    #open_logout_ico:before{
        content: '';
        display: block;
        position: relative;
        margin-right: 10px;
        float: left;
        vertical-align: center;
        width:30px;
        height: 30px;
        background-image: url("images/log_out.svg");
        background-repeat: no-repeat;
    }
    #burger_logo_user{
        position: absolute;
        left:38px;
        top: 16px;
    }
    #burger_logo_user img{
        width: 37px;
        stroke: #636DEA;
    }
    .field-visible{
        width: 800px;
        margin: auto;
    }
    .field-line{
        font-size: 13px;
        width: 800px;
        display: flex;
        margin: 20px 0 auto;
    }
    .field-wrapper{
        width: 314px;
        height: 186px;
    }
    .container-field{
        height: 159px;
        width: 314px;
        display: flex;
    }
    .left{
        justify-content: flex-start;
    }
    .right{
        justify-content: flex-end;
    }
    .trans{
        margin-top: 8px;
    }
    .trans-l{
        margin-left: 54px;
    }
    .trans-r{
        margin-left: 231px;
    }
    .trans-but{
        width: 30px;
        height: 22px;
        border-radius: 4px;
        background: #636DEA;
        color: white;
        font-family: Montserrat;
        transition-duration: .2s;
        font-weight: normal;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    .trans-but:hover{
        background: #4750BF;
        transition-duration: .2s;
        cursor: pointer;
    }
    .time-field{
        position: relative;
        width:43px;
    }
    .time-field p{
        color: #313673;
        position: absolute;
        display: block;
        width: 31px;
        bottom: 0;
        padding: 0;
        margin: 0;
    }
    .r p{
        right: 0;
    }
    .l p{
        left: 0;
    }
    .r .logo_chat{
        position: absolute;
        top: 0;
        right: 0;
    }
    .logo_chat img{
        width: 38px;
    }
    .l .logo_chat{
        position: absolute;
        top: 0;
        left: 0;
    }
    .logo_chat{
        cursor: pointer;
    }
</style>
<body>
<div class="all_chat">
    <div class="settings-container" id="settings-container-id" th:object="${session.login_user}">
        <div class="title-settings">
            <div class="arrow-wrapp">
                <div id='back_id' class="arrow-back"><img th:src="@{/images/arrow.svg}" alt=""></div>
            </div>
            <div class="title-name">Редактирование профиля</div>
        </div>
        <div class="photo-field">
            <div class="image-div">
                <img th:if="${avatar} == null" th:src="@{/images/Ellipse.png}" alt="">
                <image th:unless="${avatar} != null" th:href="${web} + ${avatar}"></image>
            </div>
            <button id="change_photo">СМЕНИТЬ ФОТО</button>
            <form id="change_photo_form" method="post" th:action="@{/im/uploadFile}" enctype="multipart/form-data">
                <table>
                    <tr>
                        <td>
                            <input type="file" name="file" accept=".jpg,.jpeg,.png"/>
                        </td>
                        <td>
                            <input type="submit" value="Загрузить">
                        </td>
                    </tr>
                </table>
            </form>
        </div>
        <div class="edit-field">
            <div class="edit-field-wrap">
                <div class="edit-str">
                    <div class="arrow-wrapp"><img th:src="@{/images/username.svg}" alt=""></div>
                    <div class="text-div"><p id="username_edited_id">Имя</p>
                        <p th:text="${name}">Имя пользователя</p></div>
                    <div class="edit-pen"><img th:src="@{/images/pen_edit.svg}" alt=""></div>
                    <div class="text-div"><p id="lastname_edited_id">Фамилия</p>
                        <p th:text="${lastName}">Фамилия пользователя</p></div>
                    <div class="edit-pen"><img th:src="@{/images/pen_edit.svg}" alt=""></div>
                </div>
            </div>
            <div class="edit-field-wrap">
                <div class="edit-str">
                    <div class="arrow-wrapp"><img class="pass_ico" th:src="@{/images/password.svg}" alt=""></div>
                    <div class="text-div"><p id="password_edited_id">&#183;&#183;&#183;&#183;&#183;&#183;&#183;&#183;</p>
                        <p>Пароль</p>
                    </div>
                    <div class="edit-pen"><img th:src="@{/images/pen_edit.svg}" alt=""></div>
                </div>
            </div>
        </div>
        <div class="edit-line"></div>
        <div th:if="${info} == null" class="field-aboutme">
            <input type="text" placeholder="О себе">
            <div class="line-aboutme"></div>
            <h5>Расскажите о себе</h5>
        </div>
        <div th:if="${info} != null" class="field-aboutme">
            <p th:text="${info}"></p>
        </div>
    </div>

    <div class="chatroom" id="chat_room_id">
        <div class="nav_menu" id="nav_menu_id">
            <div class="user_logo">
                <div class="burger_logo" id="burger_logo_user">
                    <img th:src="@{/images/burger_gray.svg}" alt="">
                </div>
                <img th:src="@{/images/Ellipse_logo.png}" alt="">
            </div>
            <div class="user_name">
                <h3 th:text="${user.email}"></h3>
            </div>
            <div class="block-wrapper">
                <div class="nav_block"><a id="open_settings_ico">Настройки</a></div>
                <div class="nav_block"><a id="open_about_ico">О нас</a></div>
            </div>
            <div class="log_out_div">
                <div class="block-wrapper lo">
                    <div class="nav_block log_out">
                        <a id='open_logout_ico' th:href="@{/main}">Выйти</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="searchchat">
            <div class="burger_logo" id="burger_logo_id"><img th:src="@{/images/burger.svg}" alt=""></div>
            <div class="search_input">
                <button id="search_but_id" class="search_but"><img th:src="@{/images/search_but.svg}" alt=""></button>
                <input type="text" placeholder="Поиск">
            </div>
        </div>

        <div class="chats" th:each="user_dialog : ${dialog_list}">
            <div class="chat_info" id="chat_info_id" th:href="@{/im/{id}(id=${user_dialog.dialog_id})}">
                <div class="container_chat_info" th:id="${user_dialog.dialog_id}" onclick="openChat(this, this.id)">
                    <div class="chat_logo">
                        <img th:src="@{/images/Ellipse.png}" alt="">
                    </div>
                    <div class="description">
                        <div class="container_description">
                            <div class="title" id="title_chat_id" th:text="${user_dialog.subject}">Название чата</div>
                            <div class="subtitle" id="subtitle_chat_id" th:text="${user_dialog.partner.email}"></div>
                        </div>
                    </div>
                    <div class="measurement" th:with="list=${user_dialog.messageList}">
                        <div th:unless="${#lists.isEmpty(list)}" th:text="${list[__${#lists.size(list) - 1}__].timestamp}" class="date"></div>
                        <div class="counter">
                            <div th:if="${user_dialog.newMessagesCount} > 0" class="circle"><p th:text="${user_dialog.newMessagesCount}"></p></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <form method="post" th:action="@{/im/create_dialog}" th:object="${new_dialog}">
            <div class="creating_chat_wrapper">
                <div class="creating_chat" id="creating_chat">
                    <div class="container_creating_chat" id="container_creating_chat_id">
                        <div class="logo"><img th:src="@{/images/logo.svg}" alt=""></div>
                        <div class="title_creating_chat"><p>Создание чата</p></div>
                        <div class="input_wrapper">
                            <input type="text" id="text_id" th:field="*{subject}" placeholder="Введите название чата" required>
                        </div>
                        <div class="input_wrapper">
                            <input type="text" th:field="*{partner.email}" placeholder="Введите собеседника">
                        </div>
                        <input type="submit" value='Создать' id="creating_chat_id">
                    </div>
                </div>
            </div>
        </form>
    </div>

    <div class="add_chat"><button id="add_chat_id">
        <img th:src="@{/images/add_chat.svg}" alt=""></button>
    </div>

    <div class="chat_field" id="chat_field_id">

        <div class="hello_logo" id="hello_logo_id">
            <img th:src="@{/images/logo.svg}" alt="">
            <h2 th:text="${user.email} + ',&nbsp'"></h2>
            <h3>общайтесь на здоровье</h3>
        </div>

        <div class="chat-field-wrapper" id="chat_field_wrapper_id"></div>
    </div>
</div>

<div id="filter"></div>

<script>
    let send_button = $('#send_button_id');

    function openChat(element, dialog_id) {
        let chatField = $("#chat_field_wrapper_id");
        chatField.css("display", "block");
        $("#hello_logo_id").css("display", "none");
        $("#chat_field_id").css("display", "block");
        $("#chat_field_id").css("background", "none");
        let url = "/image_messanger_war_exploded/im/" + dialog_id;
        chatField.load(url);
    }

    function sendMessage(element, dialog_id) {
        let messageField = $('#message_body_id');
        let message_body = messageField.val();
        let url = "/image_messanger_war_exploded/im/send_message/" + dialog_id + "/" + message_body;
        $.get(url, function(data) {
            $('#chat_field_wrapper_id').html(data);
        });
        messageField.val("");
        $('#subtitle_chat_id').attr('text', message_body);
        $('#subtitle_chat_no_messages_id').attr('text', message_body);
    }
</script>
</body>
</html>